+ cd /gpfswork/rech/gtb/ukj95zg/Scene-Graph-Benchmark-Cuda11.7
+ export CUDA_VISIBLE_DEVICES=0,1
+ CUDA_VISIBLE_DEVICES=0,1
+ srun python -m torch.distributed.launch --master_port 10026 --nproc_per_node=2 tools/relation_train_net.py --use-wandb --config-file configs/VG178/e2e_relation_X_101_32_8_FPN_1x.yaml MODEL.ROI_RELATION_HEAD.USE_GT_BOX False MODEL.ROI_RELATION_HEAD.USE_GT_OBJECT_LABEL False MODEL.ROI_RELATION_HEAD.PREDICTOR CausalAnalysisPredictor MODEL.ROI_RELATION_HEAD.CAUSAL.EFFECT_TYPE TDE MODEL.ROI_RELATION_HEAD.CAUSAL.FUSION_TYPE sum MODEL.ROI_RELATION_HEAD.CAUSAL.CONTEXT_LAYER vctree MODEL.ROI_RELATION_HEAD.CONTEXT_HIDDEN_DIM 1024 SOLVER.IMS_PER_BATCH 24 TEST.IMS_PER_BATCH 2 DTYPE float16 SOLVER.MAX_ITER 50000 SOLVER.VAL_PERIOD 2000 SOLVER.CHECKPOINT_PERIOD 4000 SOLVER.BASE_LR 0.02 SOLVER.PRE_VAL False GLOVE_DIR /gpfswork/rech/gtb/ukj95zg/glove MODEL.PRETRAINED_DETECTOR_CKPT /gpfswork/rech/gtb/ukj95zg/Scene-Graph-Benchmark-Cuda11.7/checkpoints/faster_rcnn/best_model_0058000.pth OUTPUT_DIR /gpfswork/rech/gtb/ukj95zg/Scene-Graph-Benchmark-Cuda11.7/checkpoints/VG178/vctree
/gpfsdswork/projects/rech/gtb/ukj95zg/miniconda3/envs/train/lib/python3.10/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
  0%|          | 0/57747 [00:00<?, ?it/s]  1%|          | 458/57747 [00:00<00:12, 4578.26it/s]  2%|▏         | 916/57747 [00:00<00:12, 4519.08it/s]  2%|▏         | 1439/57747 [00:00<00:11, 4840.75it/s]  4%|▎         | 2031/57747 [00:00<00:10, 5261.92it/s]  4%|▍         | 2558/57747 [00:00<00:10, 5100.93it/s]  5%|▌         | 3081/57747 [00:00<00:10, 5143.23it/s]  6%|▋         | 3651/57747 [00:00<00:10, 5321.13it/s]  7%|▋         | 4274/57747 [00:00<00:09, 5605.37it/s]  8%|▊         | 4860/57747 [00:00<00:09, 5682.75it/s]  9%|▉         | 5470/57747 [00:01<00:09, 5806.40it/s] 10%|█         | 6052/57747 [00:01<00:08, 5797.46it/s] 12%|█▏        | 6666/57747 [00:01<00:08, 5900.74it/s] 13%|█▎        | 7305/57747 [00:01<00:08, 6047.15it/s] 14%|█▍        | 7965/57747 [00:01<00:08, 6212.36it/s] 15%|█▍        | 8612/57747 [00:01<00:07, 6288.31it/s] 16%|█▌        | 9248/57747 [00:01<00:07, 6309.61it/s] 17%|█▋        | 9925/57747 [00:01<00:07, 6447.05it/s] 18%|█▊        | 10570/57747 [00:01<00:07, 6445.10it/s] 19%|█▉        | 11231/57747 [00:01<00:07, 6493.57it/s] 21%|██        | 11881/57747 [00:02<00:07, 6476.31it/s] 22%|██▏       | 12529/57747 [00:02<00:07, 6413.54it/s] 23%|██▎       | 13171/57747 [00:02<00:07, 6344.23it/s] 24%|██▍       | 13829/57747 [00:02<00:06, 6410.70it/s] 25%|██▌       | 14471/57747 [00:02<00:06, 6284.13it/s] 26%|██▌       | 15153/57747 [00:02<00:06, 6439.30it/s] 27%|██▋       | 15798/57747 [00:02<00:06, 6325.87it/s] 28%|██▊       | 16432/57747 [00:02<00:06, 6220.87it/s] 30%|██▉       | 17086/57747 [00:02<00:06, 6310.51it/s] 31%|███       | 17833/57747 [00:02<00:06, 6650.97it/s] 32%|███▏      | 18557/57747 [00:03<00:05, 6824.61it/s] 33%|███▎      | 19302/57747 [00:03<00:05, 7007.80it/s] 35%|███▍      | 20004/57747 [00:03<00:05, 6991.77it/s] 36%|███▌      | 20704/57747 [00:03<00:05, 6778.32it/s] 37%|███▋      | 21394/57747 [00:03<00:05, 6806.99it/s] 38%|███▊      | 22077/57747 [00:03<00:05, 6742.79it/s] 39%|███▉      | 22778/57747 [00:03<00:05, 6818.26it/s] 41%|████      | 23516/57747 [00:03<00:04, 6982.87it/s] 42%|████▏     | 24223/57747 [00:03<00:04, 7004.94it/s] 43%|████▎     | 24945/57747 [00:03<00:04, 7064.28it/s] 44%|████▍     | 25652/57747 [00:04<00:04, 6999.83it/s] 46%|████▌     | 26381/57747 [00:04<00:04, 7084.77it/s] 47%|████▋     | 27094/57747 [00:04<00:04, 7096.17it/s] 48%|████▊     | 27804/57747 [00:04<00:04, 6999.54it/s] 49%|████▉     | 28505/57747 [00:04<00:04, 6865.53it/s] 51%|█████     | 29193/57747 [00:04<00:04, 6146.71it/s] 52%|█████▏    | 29822/57747 [00:04<00:04, 5659.49it/s] 53%|█████▎    | 30403/57747 [00:04<00:05, 5349.32it/s] 54%|█████▎    | 30949/57747 [00:04<00:05, 5234.54it/s] 55%|█████▍    | 31480/57747 [00:05<00:05, 5141.06it/s] 55%|█████▌    | 31999/57747 [00:05<00:05, 5035.73it/s] 56%|█████▋    | 32506/57747 [00:05<00:05, 4892.79it/s] 57%|█████▋    | 32997/57747 [00:05<00:05, 4794.51it/s] 58%|█████▊    | 33492/57747 [00:05<00:05, 4835.94it/s] 59%|█████▉    | 33977/57747 [00:05<00:04, 4787.13it/s] 60%|█████▉    | 34461/57747 [00:05<00:04, 4798.28it/s] 61%|██████    | 34942/57747 [00:05<00:04, 4773.41it/s] 61%|██████▏   | 35420/57747 [00:05<00:04, 4726.67it/s] 62%|██████▏   | 35893/57747 [00:06<00:04, 4720.95it/s] 63%|██████▎   | 36373/57747 [00:06<00:04, 4740.98it/s] 64%|██████▍   | 36853/57747 [00:06<00:04, 4757.26it/s] 65%|██████▍   | 37329/57747 [00:06<00:04, 4755.36it/s] 65%|██████▌   | 37805/57747 [00:06<00:04, 4752.15it/s] 66%|██████▋   | 38281/57747 [00:06<00:04, 4720.75it/s] 67%|██████▋   | 38754/57747 [00:06<00:04, 4613.51it/s] 68%|██████▊   | 39216/57747 [00:06<00:04, 4580.22it/s] 69%|██████▊   | 39689/57747 [00:06<00:03, 4623.04it/s] 70%|██████▉   | 40166/57747 [00:06<00:03, 4666.21it/s] 70%|███████   | 40633/57747 [00:07<00:03, 4633.91it/s]  0%|          | 0/57747 [00:00<?, ?it/s] 71%|███████   | 41097/57747 [00:07<00:03, 4615.14it/s]  1%|          | 431/57747 [00:00<00:13, 4295.89it/s] 72%|███████▏  | 41576/57747 [00:07<00:03, 4664.35it/s]  1%|▏         | 861/57747 [00:00<00:13, 4219.54it/s] 73%|███████▎  | 42043/57747 [00:07<00:03, 4616.25it/s]  2%|▏         | 1332/57747 [00:00<00:12, 4439.93it/s] 74%|███████▎  | 42505/57747 [00:07<00:03, 4469.89it/s]  3%|▎         | 1904/57747 [00:00<00:11, 4937.61it/s] 74%|███████▍  | 42953/57747 [00:07<00:03, 4417.05it/s]  4%|▍         | 2399/57747 [00:00<00:11, 4768.20it/s] 75%|███████▌  | 43396/57747 [00:07<00:03, 4370.15it/s]  5%|▍         | 2878/57747 [00:00<00:11, 4685.34it/s] 76%|███████▌  | 43834/57747 [00:07<00:03, 4293.97it/s]  6%|▌         | 3408/57747 [00:00<00:11, 4878.00it/s] 77%|███████▋  | 44264/57747 [00:07<00:03, 4278.93it/s]  7%|▋         | 3976/57747 [00:00<00:10, 5126.34it/s]  8%|▊         | 4523/57747 [00:00<00:10, 5231.40it/s] 77%|███████▋  | 44693/57747 [00:07<00:03, 4270.94it/s]  9%|▉         | 5072/57747 [00:01<00:09, 5307.49it/s] 78%|███████▊  | 45121/57747 [00:08<00:02, 4252.84it/s] 10%|▉         | 5640/57747 [00:01<00:09, 5420.49it/s] 79%|███████▉  | 45578/57747 [00:08<00:02, 4345.52it/s] 80%|███████▉  | 46026/57747 [00:08<00:02, 4382.42it/s] 11%|█         | 6183/57747 [00:01<00:09, 5389.36it/s] 12%|█▏        | 6761/57747 [00:01<00:09, 5505.97it/s] 80%|████████  | 46465/57747 [00:08<00:02, 4256.02it/s] 13%|█▎        | 7336/57747 [00:01<00:09, 5575.30it/s] 81%|████████  | 46892/57747 [00:08<00:02, 4199.35it/s] 14%|█▎        | 7937/57747 [00:01<00:08, 5704.98it/s] 82%|████████▏ | 47336/57747 [00:08<00:02, 4266.20it/s] 15%|█▍        | 8530/57747 [00:01<00:08, 5770.77it/s] 83%|████████▎ | 47782/57747 [00:08<00:02, 4321.51it/s] 16%|█▌        | 9122/57747 [00:01<00:08, 5813.15it/s] 83%|████████▎ | 48215/57747 [00:08<00:02, 4294.31it/s] 17%|█▋        | 9721/57747 [00:01<00:08, 5863.02it/s] 84%|████████▍ | 48689/57747 [00:08<00:02, 4424.18it/s] 18%|█▊        | 10331/57747 [00:01<00:07, 5929.57it/s] 85%|████████▌ | 49132/57747 [00:09<00:01, 4337.03it/s] 19%|█▉        | 10934/57747 [00:02<00:07, 5959.57it/s] 86%|████████▌ | 49567/57747 [00:09<00:01, 4301.63it/s] 20%|█▉        | 11531/57747 [00:02<00:07, 5935.61it/s] 87%|████████▋ | 50046/57747 [00:09<00:01, 4443.63it/s] 21%|██        | 12125/57747 [00:02<00:07, 5924.41it/s] 87%|████████▋ | 50502/57747 [00:09<00:01, 4474.56it/s] 22%|██▏       | 12718/57747 [00:02<00:07, 5833.01it/s] 88%|████████▊ | 50950/57747 [00:09<00:01, 4413.20it/s] 23%|██▎       | 13302/57747 [00:02<00:07, 5827.37it/s] 89%|████████▉ | 51407/57747 [00:09<00:01, 4456.66it/s] 24%|██▍       | 13894/57747 [00:02<00:07, 5852.38it/s] 90%|████████▉ | 51854/57747 [00:09<00:01, 4414.46it/s] 25%|██▌       | 14490/57747 [00:02<00:07, 5882.75it/s] 91%|█████████ | 52318/57747 [00:09<00:01, 4479.60it/s] 26%|██▌       | 15123/57747 [00:02<00:07, 6013.56it/s] 91%|█████████▏| 52767/57747 [00:09<00:01, 4382.73it/s] 27%|██▋       | 15725/57747 [00:02<00:07, 5875.44it/s] 92%|█████████▏| 53207/57747 [00:09<00:01, 4387.26it/s] 28%|██▊       | 16314/57747 [00:02<00:07, 5751.12it/s] 93%|█████████▎| 53647/57747 [00:10<00:00, 4344.83it/s] 29%|██▉       | 16891/57747 [00:03<00:07, 5747.51it/s] 94%|█████████▎| 54088/57747 [00:10<00:00, 4359.55it/s] 30%|███       | 17552/57747 [00:03<00:06, 5999.65it/s] 94%|█████████▍| 54540/57747 [00:10<00:00, 4401.48it/s] 32%|███▏      | 18229/57747 [00:03<00:06, 6226.31it/s] 95%|█████████▌| 54981/57747 [00:10<00:00, 4388.64it/s] 33%|███▎      | 18891/57747 [00:03<00:06, 6341.08it/s] 96%|█████████▌| 55441/57747 [00:10<00:00, 4447.92it/s] 34%|███▍      | 19563/57747 [00:03<00:05, 6453.33it/s] 97%|█████████▋| 55886/57747 [00:10<00:00, 4415.09it/s] 35%|███▍      | 20210/57747 [00:03<00:05, 6325.11it/s] 98%|█████████▊| 56328/57747 [00:10<00:00, 4285.29it/s] 36%|███▌      | 20844/57747 [00:03<00:05, 6172.20it/s] 98%|█████████▊| 56758/57747 [00:10<00:00, 4131.02it/s] 37%|███▋      | 21478/57747 [00:03<00:05, 6219.40it/s] 99%|█████████▉| 57173/57747 [00:10<00:00, 4120.67it/s] 38%|███▊      | 22101/57747 [00:03<00:05, 6182.99it/s]100%|█████████▉| 57587/57747 [00:10<00:00, 4018.19it/s]100%|██████████| 57747/57747 [00:11<00:00, 5246.54it/s]
 39%|███▉      | 22736/57747 [00:03<00:05, 6230.59it/s] 41%|████      | 23416/57747 [00:04<00:05, 6397.78it/s] 42%|████▏     | 24057/57747 [00:04<00:05, 6390.26it/s] 43%|████▎     | 24716/57747 [00:04<00:05, 6449.28it/s] 44%|████▍     | 25362/57747 [00:04<00:05, 6372.56it/s] 45%|████▌     | 26007/57747 [00:04<00:04, 6391.00it/s] 46%|████▌     | 26667/57747 [00:04<00:04, 6452.90it/s] 47%|████▋     | 27313/57747 [00:04<00:04, 6398.48it/s] 48%|████▊     | 27954/57747 [00:04<00:04, 6300.74it/s] 50%|████▉     | 28585/57747 [00:04<00:04, 6225.04it/s] 51%|█████     | 29208/57747 [00:05<00:05, 5547.68it/s] 52%|█████▏    | 29776/57747 [00:05<00:05, 5138.64it/s] 52%|█████▏    | 30303/57747 [00:05<00:05, 4885.18it/s] 53%|█████▎    | 30801/57747 [00:05<00:05, 4798.51it/s] 54%|█████▍    | 31287/57747 [00:05<00:05, 4748.27it/s] 55%|█████▌    | 31766/57747 [00:05<00:05, 4656.46it/s] 56%|█████▌    | 32234/57747 [00:05<00:05, 4589.62it/s] 57%|█████▋    | 32695/57747 [00:05<00:05, 4462.29it/s] 57%|█████▋    | 33143/57747 [00:05<00:05, 4418.86it/s] 58%|█████▊    | 33592/57747 [00:06<00:05, 4438.90it/s] 59%|█████▉    | 34040/57747 [00:06<00:05, 4448.79it/s] 60%|█████▉    | 34486/57747 [00:06<00:05, 4440.84it/s] 60%|██████    | 34931/57747 [00:06<00:05, 4413.25it/s] 61%|██████▏   | 35373/57747 [00:06<00:05, 4376.41it/s] 62%|██████▏   | 35819/57747 [00:06<00:04, 4398.78it/s] 63%|██████▎   | 36259/57747 [00:06<00:04, 4389.60it/s] 64%|██████▎   | 36701/57747 [00:06<00:04, 4397.98it/s] 64%|██████▍   | 37141/57747 [00:06<00:04, 4394.42it/s] 65%|██████▌   | 37610/57747 [00:06<00:04, 4475.66it/s] 66%|██████▌   | 38058/57747 [00:07<00:04, 4467.18it/s] 67%|██████▋   | 38505/57747 [00:07<00:04, 4352.54it/s] 67%|██████▋   | 38941/57747 [00:07<00:04, 4261.30it/s] 68%|██████▊   | 39379/57747 [00:07<00:04, 4293.43it/s] 69%|██████▉   | 39814/57747 [00:07<00:04, 4307.51it/s] 70%|██████▉   | 40260/57747 [00:07<00:04, 4349.25it/s] 70%|███████   | 40699/57747 [00:07<00:03, 4357.86it/s] 71%|███████   | 41136/57747 [00:07<00:03, 4318.33it/s] 72%|███████▏  | 41581/57747 [00:07<00:03, 4355.80it/s] 73%|███████▎  | 42017/57747 [00:07<00:03, 4333.63it/s] 74%|███████▎  | 42451/57747 [00:08<00:03, 4264.07it/s] 74%|███████▍  | 42878/57747 [00:08<00:03, 4160.13it/s] 75%|███████▍  | 43295/57747 [00:08<00:03, 4112.44it/s] 76%|███████▌  | 43707/57747 [00:08<00:03, 4057.38it/s] 76%|███████▋  | 44114/57747 [00:08<00:03, 4001.41it/s] 77%|███████▋  | 44515/57747 [00:08<00:03, 4001.77it/s] 78%|███████▊  | 44916/57747 [00:08<00:03, 3963.91it/s] 78%|███████▊  | 45326/57747 [00:08<00:03, 4000.72it/s] 79%|███████▉  | 45773/57747 [00:08<00:02, 4138.15it/s] 80%|███████▉  | 46188/57747 [00:08<00:02, 4105.80it/s] 81%|████████  | 46599/57747 [00:09<00:02, 3949.25it/s] 81%|████████▏ | 46996/57747 [00:09<00:02, 3907.62it/s] 82%|████████▏ | 47420/57747 [00:09<00:02, 4000.16it/s] 83%|████████▎ | 47832/57747 [00:09<00:02, 4033.46it/s] 84%|████████▎ | 48237/57747 [00:09<00:02, 4016.38it/s] 84%|████████▍ | 48676/57747 [00:09<00:02, 4124.70it/s] 85%|████████▌ | 49089/57747 [00:09<00:02, 4045.57it/s] 86%|████████▌ | 49495/57747 [00:09<00:02, 4038.85it/s] 86%|████████▋ | 49933/57747 [00:09<00:01, 4137.65it/s] 87%|████████▋ | 50352/57747 [00:10<00:01, 4150.71it/s] 88%|████████▊ | 50768/57747 [00:10<00:01, 4106.80it/s] 89%|████████▊ | 51179/57747 [00:10<00:01, 4105.35it/s] 89%|████████▉ | 51599/57747 [00:10<00:01, 4130.13it/s] 90%|█████████ | 52013/57747 [00:10<00:01, 4079.02it/s] 91%|█████████ | 52454/57747 [00:10<00:01, 4170.68it/s] 92%|█████████▏| 52872/57747 [00:10<00:01, 4089.98it/s] 92%|█████████▏| 53288/57747 [00:10<00:01, 4106.80it/s] 93%|█████████▎| 53700/57747 [00:10<00:00, 4059.11it/s] 94%|█████████▎| 54111/57747 [00:10<00:00, 4072.05it/s] 94%|█████████▍| 54534/57747 [00:11<00:00, 4117.40it/s] 95%|█████████▌| 54946/57747 [00:11<00:00, 4073.40it/s] 96%|█████████▌| 55380/57747 [00:11<00:00, 4150.74it/s] 97%|█████████▋| 55796/57747 [00:11<00:00, 4116.60it/s] 97%|█████████▋| 56208/57747 [00:11<00:00, 4069.31it/s] 98%|█████████▊| 56616/57747 [00:11<00:00, 3870.11it/s] 99%|█████████▊| 57006/57747 [00:11<00:00, 3877.90it/s] 99%|█████████▉| 57396/57747 [00:11<00:00, 3793.15it/s]100%|██████████| 57747/57747 [00:11<00:00, 4864.45it/s]
wandb: Tracking run with wandb version 0.16.1
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
wandb: Tracking run with wandb version 0.16.1
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
/gpfsdswork/projects/rech/gtb/ukj95zg/miniconda3/envs/train/lib/python3.10/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/gpfsdswork/projects/rech/gtb/ukj95zg/miniconda3/envs/train/lib/python3.10/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
[W reducer.cpp:1298] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1298] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
srun: Job step aborted: Waiting up to 62 seconds for job step to finish.
slurmstepd: error: *** STEP 1735165.0 ON r8i3n3 CANCELLED AT 2023-12-14T13:03:29 ***
slurmstepd: error: *** JOB 1735165 ON r8i3n3 CANCELLED AT 2023-12-14T13:03:29 ***
WARNING:torch.distributed.elastic.agent.server.api:Received 15 death signal, shutting down workers
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 118201 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 118202 closing signal SIGTERM
